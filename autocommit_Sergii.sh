#!/bin/bash

# Проверка, что путь к репозиторию был передан как аргумент
if [ -z "$1" ]; then
    echo "Пожалуйста, укажите путь к репозиторию Git."
    exit 1
fi

# Этап 1: Проверка на наличие репозитория Git в указанном пути
repo_path="$1"

if [ ! -d "$repo_path/.git" ]; then
    echo "В указанном пути нет Git-репозитория. Пожалуйста, укажите корректный путь."
    exit 1
fi

# Переходим в указанный репозиторий
cd "$repo_path" || exit

# Этап 2: Добавление изменений в индекс
echo "Добавление изменений в индекс..."
git add .

# Этап 3: Проверка наличия изменений для коммита
if ! git diff --cached --quiet; then
    echo "Изменения добавлены в индекс."
else
    echo "Нет изменений для коммита."
    exit 0
fi

# Этап 4: Фиксация изменений и создание коммита
commit_message="Commit from script $(date +'%Y-%m-%d %H:%M:%S')"
git commit -m "$commit_message"

# Этап 5: Вывод сообщений об успешном выполнении или отсутствии изменений
if [ $? -eq 0 ]; then
    echo "Коммит успешно выполнен!"
else
    echo "Ошибка при создании коммита."
fi
